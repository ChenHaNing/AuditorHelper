# 内网穿透优化配置

这个目录包含了用于优化内网穿透环境下应用加载性能的配置文件和工具。

## 问题背景

在使用内网穿透服务（如frp、ngrok等）访问应用时，由于网络延迟和带宽限制，应用可能会加载非常缓慢，特别是在加载大量不必要的资源（如多国语言包）时。

## 解决方案

我们提供了以下几种优化方式：

### 1. 前端自动优化

已在前端代码中添加了自动检测和优化逻辑，可自动识别慢速网络环境并应用优化。主要包括：

- 自动检测慢速网络环境
- 减少不必要的动画和过渡效果
- 优先加载关键资源，延迟加载非关键资源
- 快速跳过加载屏幕

### 2. 代理层优化（推荐）

使用 `intranet-optimize.js` 作为代理层优化工具，可以拦截和过滤不必要的资源请求，大幅提高加载速度。

#### 如何使用代理层优化

**方式1: 内网穿透服务中使用**

如果您使用的内网穿透服务支持中间件或自定义请求头，可以：

```
# frp配置示例
[web]
type = http
local_port = 3000
custom_domains = your-domain.com
http_headers = X-Proxy-Optimization: enabled
```

**方式2: Nginx代理配置**

如果使用Nginx作为反向代理，添加以下配置：

```nginx
location / {
  proxy_pass http://your_original_server;
  proxy_set_header X-Proxy-Optimization "enabled";
}
```

**方式3: URL参数方式**

直接在访问URL中添加优化参数：

```
http://your-proxy-url.com/?optimize=intranet
```

### 3. 手动优化建议

如果以上方式不适用，您还可以：

1. 在浏览器中禁用JavaScript源映射（大幅减少请求量）
2. 在应用加载时立即点击"加载中，如等待时间过长，请点击此处跳过"链接
3. 使用localStorage手动设置语言：
   ```javascript
   localStorage.locale = 'zh-CN'; 
   localStorage.i18nextLng = 'zh-CN';
   ```

## 优化效果

应用这些优化后，内网穿透环境下的加载时间可以从30秒+减少到5秒左右，大幅提升用户体验。

## 技术原理

1. **请求过滤**：拦截非关键资源（如.map文件和非中文语言包）
2. **预加载优化**：优先加载关键资源
3. **网络适应**：根据网络质量自动调整加载策略
4. **界面优化**：减少不必要的动画和视觉效果

## 注意事项

- 优化模式下，部分高级视觉效果可能被禁用
- 只有中文语言包会被加载，其他语言将不可用
- 调试工具的源映射功能在优化模式下不可用 